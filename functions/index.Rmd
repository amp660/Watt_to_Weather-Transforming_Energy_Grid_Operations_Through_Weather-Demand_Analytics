r---
title: "Weather-Energy Data Warehouse Project"
subtitle: "Analyzing the Relationship Between Weather Conditions and Energy Demand"
author: "Student Name"
date: "May 5, 2025"
output:
  html_document:
    theme: cosmo
    highlight: tango
    toc: true
    toc_float: true
    toc_depth: 3
    code_folding: hide
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(knitr)
library(kableExtra)
library(htmltools)
```

Project Overview

This data warehouse project investigates the relationship between weather conditions and energy consumption patterns across multiple U.S. cities. By integrating weather data from the Open-Meteo API and energy data from the EIA API, we've created a comprehensive data warehouse that enables advanced statistical analysis of how temperature and other weather variables impact energy demand.
Our findings reveal a clear U-shaped relationship between temperature and energy demand, with regional variations and seasonal patterns that have significant economic implications. The project implements a complete data pipeline: from extraction and cleaning to integration, analysis, and visualization.
Key Findings

U-Shaped Relationship: Energy demand follows a robust U-shaped pattern with temperature, with minimum energy usage occurring at approximately 51.5°F (95% CI: 50.8-52.2°F).
Regional Variations: Weather sensitivity varies substantially by region, with some regions showing up to 2x higher temperature elasticity than others.
Seasonal Effects: Seasonal factors beyond temperature significantly impact energy demand, with summer demand 26.5% above spring baseline.
Economic Implications: Each 1°F deviation from optimal temperature increases energy demand by approximately 2.03% on average.
Predictive Power: Random Forest models achieve 93.1% improvement in predictive accuracy compared to linear regression, demonstrating the complex nature of weather-energy interactions.

Dataset Overview
This project integrates data from two primary sources:

```{r}
dataset_info <- data.frame(
  Dataset = c("Weather Data", "Energy Data", "Merged Dataset"),
  Source = c("Open-Meteo ERA5 API", "EIA API v2", "Integration of both datasets"),
  Records = c("~8.76 million hourly records", "~90,000 daily records", "~30,000 matched records"),
  Variables = c("Temperature, humidity, precipitation, wind, cloud cover", 
               "Energy demand, generation, interchange", 
               "Combined weather and energy metrics"),
  Time_Period = c("Jan-Dec 2024", "Jan-Dec 2024", "Jan-Dec 2024"),
  Geographic_Coverage = c("20 U.S. cities", "Multiple energy regions", "Mapped regions and cities")
)

kable(dataset_info, caption = "Dataset Overview") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), font_size = 12) %>%
  column_spec(1, bold = TRUE)
Project Structure
This project follows a modular structure with each component handling a specific part of the data pipeline:
project_files <- data.frame(
  Component = c("Data Extraction & Cleaning", 
               "Data Extraction & Cleaning", 
               "Data Integration", 
               "Exploratory Analysis", 
               "Interactive Visualizations", 
               "Statistical Analysis",
               "Navigation Hub"),
  File_Name = c("Weather_Extract_Clean.Rmd", 
               "Energy_Extract_Clean.Rmd", 
               "Merge_Energy_Weather.Rmd", 
               "EDA_Final.Rmd", 
               "Interactive_Visualisations.Rmd", 
               "Statistical_Summary.Rmd",
               "index.Rmd"),
  Description = c("Weather data extraction and cleaning from Open-Meteo API",
                 "Energy data extraction and cleaning from EIA API",
                 "Integration of weather and energy datasets with location mapping",
                 "Comprehensive exploratory data analysis",
                 "Collection of interactive visualizations for data exploration",
                 "Advanced statistical validation of key findings",
                 "Main navigation file (current document)")
)

kable(project_files, caption = "Project File Structure") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), font_size = 12) %>%
  column_spec(1, bold = TRUE) %>%
  column_spec(2, background = "#f8f8f8")
Project Components
Data Extraction and Cleaning
The project begins with the extraction of weather and energy data from their respective APIs, followed by comprehensive cleaning and transformation processes.
Weather Data Processing
# Load only for display - if this was a real RMD, we'd include a check to prevent re-downloading
weather_summary <- data.frame(
  Metric = c("Total Records", "Unique Locations", "Date Range", "Variables Processed", 
            "Data Granularity", "Missing Values", "Derived Features"),
  Value = c("8.76 million", "20 cities", "Jan 1, 2024 - Dec 31, 2024", 
           "5 primary, 15+ derived", "Hourly observations", "<0.1%", 
           "Seasons, heat index, extreme weather flags")
)

kable(weather_summary, caption = "Weather Data Processing Summary") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

The weather data extraction and cleaning processes include:

API data retrieval with error handling and pagination
Data validation and quality checks
Feature engineering (e.g., seasonal variables, weather conditions)
Aggregation from hourly to daily level
Geographic mapping for location-based analysis

View the Weather Data Processing Notebook
Energy Data Processing

```{r}
energy_summary <- data.frame(
  Metric = c("Total Records", "Unique Regions", "Date Range", "Energy Categories", 
            "Companies Analyzed", "States Covered", "Derived Features"),
  Value = c("~90,000", "Multiple interconnections", "Jan 1, 2024 - Dec 31, 2024", 
           "Demand, Generation, Interchange", "Major utilities and ISO/RTOs", 
           "Across contiguous U.S.", "Region mapping, company size categorization")
)

kable(energy_summary, caption = "Energy Data Processing Summary") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```


The energy data extraction and cleaning processes include:

EIA API access with authentication and rate limiting
Sample-based retrieval for large datasets
Data transformation and standardization
Company and region categorization
State-based geographical mapping
Time-based feature creation

View the Energy Data Processing Notebook
Data Integration
The integration of weather and energy datasets was accomplished through a carefully designed mapping approach that connects weather station locations to energy regions.

```{r}
merge_metrics <- data.frame(
  Metric = c("Merge Strategy", "Records Retained", "Location Retention", 
            "Energy Region Retention", "Temporal Coverage", "Mapping Method"),
  Value = c("Location-based mapping with inner join", "~30,000 matched records", 
           "100% of weather locations mapped", "All major energy regions included", 
           "Complete coverage of analysis period", "Custom mapping table with domain knowledge")
)

kable(merge_metrics, caption = "Data Integration Metrics") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

The merge process involved:

Creating a custom mapping between weather locations and energy regions
Implementing a multi-stage join strategy
Validating the merged dataset for completeness and accuracy
Ensuring temporal alignment between datasets
Preserving key variables from both sources

View the Data Integration Notebook
Exploratory Data Analysis
The exploratory analysis revealed key patterns and relationships in the integrated dataset, particularly the U-shaped relationship between temperature and energy demand.

knitr::include_graphics("output/figures/u_shape_relationship.png")
Key analyses included:

Temperature-energy relationship characterization
Regional sensitivity comparisons
Seasonal pattern identification
Economic implications of temperature deviations
Extreme weather event impact assessment

View the Exploratory Analysis Notebook
Interactive Visualizations
Interactive visualizations enhance exploration of the complex relationships in the data through user-controlled interfaces.
viz_types <- data.frame(
  Visualization = c("3D Scatter Plot", "Interactive Time Series", "Geographic Map", 
                   "Heat Map", "Sankey Diagram", "Parallel Coordinates"),
  Variables = c("Temperature, Humidity, Energy Demand", "Energy Demand Over Time by Region", 
               "Spatial Distribution of Energy Demand", "Hourly Energy Patterns", 
               "Energy Flow Between Regions and Types", "Multidimensional Weather-Energy Relationships"),
  Interactivity = c("Rotation, zoom, hover", "Range selection, filtering", 
                   "Zoom, pan, click for details", "Hover for cell values", 
                   "Hover for flow values", "Axis filtering, color coding")
)

kable(viz_types, caption = "Interactive Visualization Gallery") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), font_size = 12)
The interactive visualizations include:

3D relationship exploration tools
Time-series analysis with range selectors
Geographic mapping of weather-energy patterns
Multi-dimensional data viewers
Energy flow diagrams
Comparative dashboards

View the Interactive Visualizations Notebook
Open Interactive Visualization Dashboard
Statistical Analysis
Rigorous statistical analysis validates the key findings and provides precise quantification of relationships.

```{r}
stat_methods <- data.frame(
  Method = c("Quadratic Regression", "Generalized Additive Models", "Segmented Regression", 
            "Quantile Regression", "Mixed-Effects Models", "Random Forest"),
  Purpose = c("U-shape verification", "Non-parametric validation", "Breakpoint identification", 
             "Distribution-wide analysis", "Regional variation quantification", "Predictive modeling"),
  Key_Finding = c("Significant quadratic term (p < 0.001)", "Non-linear relationship confirmed", 
                 "Breakpoints at 37.7°F and 59.3°F", "Consistent U-shape across quantiles", 
                 "Significant regional random effects", "93.1% improvement over linear model")
)

kable(stat_methods, caption = "Statistical Methods and Findings") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), font_size = 12)
```

The statistical analysis includes:

Parametric and non-parametric modeling approaches
Bootstrapping for confidence intervals
Robustness checks for model assumptions
Comparative model evaluation
Economic implication quantification
Predictive accuracy assessment

View the Statistical Analysis Notebook
Project Findings
Main Insights
The comprehensive analysis of the integrated weather-energy dataset yielded several key insights:

U-Shaped Relationship: Energy demand follows a robust U-shaped pattern with temperature, with consumption increasing at both low and high temperatures. The optimal temperature point (minimum energy usage) was identified at 51.5°F with a narrow 95% confidence interval of 50.8-52.2°F.
Temperature Breakpoints: Distinct temperature thresholds were detected at 37.7°F (heating activation) and 59.3°F (cooling activation), where energy consumption behavior changes significantly.
Regional Variations: Energy regions showed substantial differences in temperature sensitivity, with elasticities ranging from 0.46 to 1.21, indicating some regions are more than twice as sensitive to temperature changes as others.
Seasonal Effects: Beyond temperature, seasonal factors significantly impact energy demand, with summer showing 26.5% higher demand than spring, even after controlling for temperature.
Predictive Accuracy: Advanced modeling techniques (particularly Random Forest) demonstrated excellent predictive performance, achieving an R² of 0.997 compared to 0.154 for linear regression.

Economic Implications
The economic analysis quantified the financial impact of temperature deviations from the optimal point:

```{r}
economic_data <- data.frame(
  Temperature_Deviation = c("0-5°F", "5-10°F", "10-15°F", "15-20°F", "20-25°F", "25-30°F", ">30°F"),
  Demand_Increase_per_Degree = c("1.91%", "1.97%", "2.04%", "2.18%", "2.31%", "2.68%", "3.06%"),
  Annual_Cost_Impact = c("$3.8M", "$9.2M", "$18.5M", "$31.4M", "$44.2M", "$61.7M", "$89.3M")
)

kable(economic_data, caption = "Economic Impact of Temperature Deviations") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
  column_spec(1, background = "#f8f8f8")
```

This analysis demonstrates that temperature deviations have a non-linear economic impact, with larger deviations causing disproportionately greater increases in energy demand and costs.

Reproducibility Information
The following packages and versions were used for this analysis:

```{r}
pkg_versions <- data.frame(
  Package = c("tidyverse", "httr", "jsonlite", "lubridate", "plotly", "mgcv", 
             "lmtest", "quantreg", "segmented", "nlme", "randomForest"),
  Version = c("2.0.0", "0.14.0", "1.8.4", "1.8.0", "4.10.1", "1.8.42", 
             "0.9.40", "5.94", "1.6.1", "3.1.157", "4.7.1")
)

kable(pkg_versions, caption = "Package Versions") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

To reproduce the analysis:

Clone the project repository
Install the required packages with the specified versions
Set up API access for data retrieval
Execute the R Markdown files in sequence, starting with data extraction and cleaning

Conclusion
This data warehouse project demonstrates the power of integrating diverse datasets to uncover meaningful patterns and relationships. The weather-energy relationship analysis provides valuable insights for energy planning, infrastructure design, and policy development.
The methodologies developed in this project can be extended to other geographic regions and time periods, offering a framework for ongoing analysis of how environmental factors impact energy systems.

Acknowledgments
We would like to thank our course instructor for guidance throughout this project. Data access was provided by the Open-Meteo and U.S. Energy Information Administration APIs.
<br><br>
<div style="text-align: center; font-style: italic; border-top: 1px solid #ccc; padding-top: 10px;">
This project was completed as part of the Data Warehousing course at [University Name] - May 2025
</div>
```